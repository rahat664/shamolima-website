<ng-container *ngIf="home$ | async as home">
  <section class="page-hero page-hero--navy home-hero" @fadeIn>
    <!-- Carousel Background Images -->
    <div class="home-hero__carousel">
      <div class="home-hero__slide" *ngIf="heroSlideIndex === 0" [class.active]="true">
        <picture>
          <source srcset="assets/images/webp/fleet_yard.webp" type="image/webp">
          <img class="home-hero__image"
               ngSrc="assets/images/fleet_yard.jpg"
               fill
               [priority]="heroSlideIndex === 0"
               alt="">
        </picture>
      </div>
      <div class="home-hero__slide" *ngIf="heroSlideIndex === 1" [class.active]="true">
        <picture>
          <source srcset="assets/images/webp/generator_transformer.webp" type="image/webp">
          <img class="home-hero__image"
               ngSrc="assets/images/generator_transformer.jpg"
               fill
               [priority]="heroSlideIndex === 1"
               alt="">
        </picture>
      </div>
      <div class="home-hero__slide" *ngIf="heroSlideIndex === 2" [class.active]="true">
        <picture>
          <source srcset="assets/images/webp/project_equipment.webp" type="image/webp">
          <img class="home-hero__image"
               ngSrc="assets/images/project_equipment.jpg"
               fill
               [priority]="heroSlideIndex === 2"
               alt="">
        </picture>
      </div>
    </div>

    <div class="page-hero__layer page-hero__layer--gradient"></div>
    <div class="page-hero__orb page-hero__orb--one"></div>
    <div class="page-hero__orb page-hero__orb--two"></div>

    <div class="container grid gap-12 lg:grid-cols-[minmax(0,1.15fr)_minmax(0,1fr)] lg:items-center">
      <div>
        <p class="kicker text-brand">Shamolima Limited</p>
        <h1 class="page-hero__title">{{ home.hero.headline }}</h1>
        <p class="page-hero__lede" appRevealOnScroll="fade" [delay]="800">{{ home.hero.subhead }}</p>

        <div class="page-hero__tags" role="list" appRevealOnScroll="up" [delay]="1000">
          <span class="tag-chip" *ngFor="let tag of heroTags; trackBy: trackByTag" role="listitem">{{ tag }}</span>
        </div>

        <div class="page-hero__actions" appRevealOnScroll="up" [delay]="1200">
          <a routerLink="/quote" class="btn btn-primary btn--glow">Start a project brief</a>
          <a routerLink="/services" class="btn btn--light">Explore services</a>
        </div>
      </div>

      <div class="grid gap-4 sm:grid-cols-2">
        <article *ngFor="let stat of stats; let i = index" class="stat-card" appRevealOnScroll="zoom" [delay]="i * 150">
          <div class="stat-card__value" [appAnimateCounter]="stat.value" [counterDuration]="2000" [counterDelay]="400 + (i * 150)"></div>
          <p class="stat-card__label">{{ stat.label }}</p>
          <p *ngIf="stat.detail" class="stat-card__detail">{{ stat.detail }}</p>
        </article>
      </div>
    </div>

    <!-- Carousel Indicators -->
    <div class="hero-carousel-dots">
      <button *ngFor="let i of [0,1,2]"
              class="hero-carousel-dot"
              [class.active]="heroSlideIndex === i"
              (click)="setHeroSlide(i)"
              [attr.aria-label]="'Go to slide ' + (i + 1)">
      </button>
    </div>
  </section>
</ng-container>

<section class="section section--bright" @fadeIn>
  <div class="container grid gap-10 lg:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)]">
    <div>
      <p class="kicker text-brand" appRevealOnScroll="fade">Integrated project logistics</p>
      <h2 class="section-title" appRevealOnScroll="up" [delay]="100">End-to-end support for energy, infrastructure and industrial moves</h2>
      <p class="section-lede" appRevealOnScroll="fade" [delay]="200">{{ aboutSnippet$ | async }}</p>

      <div class="mt-10 grid gap-6 sm:grid-cols-2">
        <article *ngFor="let pillar of focusAreas; trackBy: trackByFocus; let i = index" class="feature-card" appRevealOnScroll="up" [delay]="i * 100">
          <span class="feature-card__badge">{{ pillar.badge }}</span>
          <h3 class="feature-card__title">{{ pillar.title }}</h3>
          <p class="feature-card__copy">{{ pillar.copy }}</p>
        </article>
      </div>
    </div>

    <aside class="insight-card" appRevealOnScroll="left" [delay]="200">
      <h3 class="insight-card__heading">Why teams choose Shamolima</h3>
      <ul class="insight-card__list">
        <li *ngFor="let item of highlights; trackBy: trackByHighlight">
          <span class="insight-card__title">{{ item.title }}</span>
          <span class="insight-card__detail">{{ item.detail }}</span>
        </li>
      </ul>

      <div class="insight-card__cta" *ngIf="(certificates$ | async) as certificates">
        <p class="font-semibold">Certifications & memberships</p>
        <div class="home-certificates">
          <img *ngFor="let cert of certificates; trackBy: trackByUrl" [src]="cert" alt="Certification" loading="lazy">
        </div>
      </div>

      <div class="insight-card__cta" *ngIf="contactEmail$ | async as email">
        <p class="font-semibold">Need mobilisation expertise?</p>
        <p>Email <a class="text-brand hover:underline" [href]="'mailto:' + email">{{ email }}</a> to reach our project desk.</p>
      </div>
    </aside>
  </div>
</section>

<ng-container *ngIf="(spotlight$ | async) as spotlight">
  <section *ngIf="spotlight.length" class="section section--navy" @fadeIn>
    <div class="container">
      <div class="flex flex-wrap items-end justify-between gap-6">
        <div>
          <p class="kicker text-brand" appRevealOnScroll="fade">Spotlight operations</p>
          <h2 class="section-title text-white" appRevealOnScroll="up" [delay]="100">What our crews are delivering right now</h2>
        </div>
        <p class="max-w-xl text-sm text-white/70" appRevealOnScroll="fade" [delay]="200">
          Recent heavy haul, lifting and site support executed across Bangladesh. Each move reflects our integrated Shamolima Limited approach.
        </p>
      </div>

      <div class="spotlight-carousel mt-10" *ngIf="spotlight as slides" (mouseenter)="pauseAutoplay()" (mouseleave)="resumeAutoplay()">
        <button class="carousel__nav carousel__nav--prev" type="button" aria-label="Previous" (click)="prevSpotlight(slides.length)">&#10094;</button>
        <div class="carousel__viewport">
          <article *ngFor="let item of slides; let i = index; trackBy: trackByImage"
                   class="spotlight-card"
                   [class.is-active]="i === spotlightIndex"
                   [hidden]="i !== spotlightIndex">
            <img [src]="item.image" [alt]="item.caption" loading="lazy" class="spotlight-card__image">
            <div class="spotlight-card__scrim"></div>
            <div class="spotlight-card__content">
              <span class="spotlight-card__badge">Featured move</span>
              <h3 class="spotlight-card__title">{{ item.caption }}</h3>
            </div>
          </article>
        </div>
        <button class="carousel__nav carousel__nav--next" type="button" aria-label="Next" (click)="nextSpotlight(slides.length)">&#10095;</button>
      </div>
    </div>
  </section>
</ng-container>

<section class="section" @fadeIn>
  <div class="container">
    <p class="kicker text-brand" appRevealOnScroll="fade">Clients</p>
    <h2 class="section-title" appRevealOnScroll="up" [delay]="100">Trusted by operators &amp; EPCs</h2>
    <div class="client-grid mt-6" *ngIf="clients$ | async as clients" appRevealOnScroll="zoom" [delay]="200">
      <ng-container *ngFor="let c of clients; trackBy: trackByClient">
        <img *ngIf="c.logo; else nameChip"
             class="client-logo"
             [src]="c.logo"
             [alt]="c.name"
             loading="lazy">
        <ng-template #nameChip>
          <span class="client-chip">{{ c.name }}</span>
        </ng-template>
      </ng-container>
    </div>
  </div>
</section>

<section class="section" @fadeIn>
  <div class="container">
    <p class="kicker text-brand" appRevealOnScroll="fade">How we deliver</p>
    <h2 class="section-title" appRevealOnScroll="up" [delay]="100">Lifecycle support from first brief to final handover</h2>

    <div class="mt-10 grid gap-8 md:grid-cols-2">
      <article *ngFor="let phase of phases; trackBy: trackByPhase; index as idx" class="phase-card" appRevealOnScroll="flip" [delay]="idx * 150">
        <div class="phase-card__index">{{ idx + 1 }}</div>
        <h3 class="phase-card__title">{{ phase.title }}</h3>
        <p class="phase-card__copy">{{ phase.copy }}</p>
        <ul class="phase-card__list">
          <li *ngFor="let point of phase.points">{{ point }}</li>
        </ul>
      </article>
    </div>
  </div>
</section>

<section class="section section--bright" @fadeIn>
  <div class="container">
    <p class="kicker text-brand" appRevealOnScroll="fade">Recent projects</p>
    <h2 class="section-title" appRevealOnScroll="up" [delay]="100">Selected references</h2>
    <div class="mt-8 grid gap-6 md:grid-cols-2">
      <article *ngFor="let p of (recentProjects$ | async)!; trackBy: trackByProject; let i = index" class="feature-card" appRevealOnScroll="up" [delay]="i * 100">
        <span class="feature-card__badge">RP</span>
        <h3 class="feature-card__title">{{ p.title }}</h3>
        <p class="feature-card__copy">{{ p.description }}</p>
        <p class="text-sm text-slate-500 mt-2"><strong>Location:</strong> {{ p.location }}</p>
        <div class="mt-2 flex flex-wrap gap-2">
          <span class="chip" *ngFor="let eq of p.keyEquipment">{{ eq }}</span>
        </div>
      </article>
    </div>
  </div>
</section>

<section class="section section--gallery" id="gallery" [@listStagger]>
  <div class="container">
    <div class="flex flex-wrap items-end justify-between gap-6">
      <div>
        <p class="kicker text-brand" appRevealOnScroll="fade">Field execution gallery</p>
        <h2 class="section-title" appRevealOnScroll="up" [delay]="100">Highlights from our yards & job sites</h2>
        <p class="section-lede" appRevealOnScroll="fade" [delay]="200">
          Explore select shots from multimodal projects, engineered lifts and commissioning support executed by Shamolima teams.
        </p>
      </div>
    </div>

    <div *ngIf="(galleryItems$ | async) as items" class="masonry mt-10 columns-1 sm:columns-2 lg:columns-3" data-gallery>
      <figure *ngFor="let item of items; trackBy: trackByImage; let i = index" class="gallery-card" appRevealOnScroll="zoom" [delay]="i * 50" [threshold]="0.05">
        <img [src]="thumbFor(item.image)" [attr.data-fullsrc]="item.image" [alt]="item.caption" loading="lazy" decoding="async" class="gallery-card__image">
        <figcaption class="gallery-card__caption">{{ item.caption }}</figcaption>
      </figure>
    </div>

    <p class="mt-6 text-xs text-slate-500" appRevealOnScroll="fade">Images are curated from recent Shamolima work activities for quick reference.</p>
  </div>
</section>

<app-footer />
